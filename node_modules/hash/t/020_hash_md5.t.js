StartTest(function(t) {
    
    var async0 = t.beginAsync()
    
    use([ 'Hash', 'joosed-samples-MD5' ], function () {
        
        //======================================================================================================================================================================================================================================================
        t.diag('Check ASCII strings against known good MD5 hash table')

        // var sys = require('sys')

        t.ok(Hash.MD5.md5_vm_test(), 'the built-in test for MD-5 passed')

        var known_good_md5_hashes_ascii = Samples_MD5.getStringsANDhashes_ASCII()
 
        var compute_and_compare_hashes = function (hash_table) {
          var result = true
          for (var i = 0 ; i < hash_table.length ; i++) {
            if (Hash.md5(hash_table[i][0]) != hash_table[i][1]) {
              // sys.puts(Hash.md5(hash_table[i][0]) + '\t' + hash_table[i][0] + '\t' + hash_table[i][1])
              result = false
            }
          }
          return result
        }

        t.ok(compute_and_compare_hashes(known_good_md5_hashes_ascii), "Computed and known good hashes for ASCII strings all match!")

        //======================================================================================================================================================================================================================================================

        t.diag('Check UTF-8 strings against known good MD5 hash table')

        var known_good_md5_hashes_utf8 = Samples_MD5.getStringsANDhashes_UTF8()
 
        var compute_and_compare_hashes = function (hash_table) {
          var result = true
          for (var i = 0 ; i < hash_table.length ; i++) {
            if (Hash.md5(hash_table[i][0]) != hash_table[i][1]) {
              // sys.puts(Hash.md5(hash_table[i][0]) + '\t' + hash_table[i][0] + '\t' + hash_table[i][1])
              result = false
            }
          }
          return result
        }

        t.ok(compute_and_compare_hashes(known_good_md5_hashes_utf8), "Computed and known good hashes for UTF-8 strings all match!")

        t.endAsync(async0)
        
        t.done()
    })
})    

